@page "/product/{id:int?}"
@model ProductPageModel
@{
    ViewData["Title"] = "Danh sách sản phẩm";
    var product = Model.product;
    var products = Model.products;
    var products_search = Model.products_search;
}

<div class="row mb-4">
    <!-- Nút Xóa tất cả, Nạp sản phẩm và Thêm sản phẩm -->
    <div class="col-md-12 mb-4">
        <div class="d-flex justify-content-end gap-2">
            <!-- Sử dụng gap-2 để tạo khoảng cách 10px -->
            <a class="btn btn-danger" asp-page-handler="RemoveAll">Xóa tất cả</a>
            <a class="btn btn-success" asp-page-handler="LoadAll">Nạp sản phẩm</a>
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addProductModal">
                Thêm sản phẩm
            </button>
        </div>
    </div>

    <!-- Nếu có sidebar riêng trong trang sản phẩm -->
    <div class="col-md-3">
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-primary text-white">
                Danh mục
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">
                    <a class="stretched-link text-decoration-none" href="@Url.Page("ProductPage", new { id = "" })">Tất cả</a>
                </li>
                @foreach (var category in Model.categories)
                {
                    <li class="list-group-item">
                        <a class="stretched-link text-decoration-none" href="@Url.Page("ProductPage", new { id = category.Id })">@category.Name</a>
                    </li>
                }
            </ul>
        </div>
    </div>

    <!-- Nội dung chính -->
    <div class="col-md-9">
        @if (Model.IsProductDetail)
        {
            <h2>@product.Name</h2>
            <p>Mô tả: @product.Description</p>
            <p class="fw-bold text-danger">Giá: @product.Price</p>
            <h3>Ảnh sản phẩm:</h3>
            <div class="row">
                @foreach (var img in product.ImagePaths)
                {
                    <div class="col-6 col-md-4 col-lg-3 mb-3">
                        <div class="card h-100">
                            <img src="@img" class="card-img-top img-fluid" alt="Ảnh sản phẩm">
                        </div>
                    </div>
                }
            </div>
            <a class="btn btn-primary" asp-page="ProductPage" asp-route-id="">Danh sách sản phẩm</a>
            <!-- Form cập nhật & xóa sản phẩm cũng được hiển thị ở đây -->
        }
        else
        {
            <h2>Danh sách sản phẩm</h2>
            @await Component.InvokeAsync("ProductBox", new { sapxeptang = true, categoryId = Model.categoryId })
        }
    </div>
</div>

<!-- Nút cuộn lên đầu -->
<button id="scrollToTopBtn" class="btn btn-primary scroll-to-top" onclick="scrollToTop()">⬆ Lên đầu</button>

<style>
    .scroll-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        display: none;
        z-index: 1000;
    }
</style>

<script>
    window.onscroll = function () {
        var btn = document.getElementById("scrollToTopBtn");
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            btn.style.display = "block";
        } else {
            btn.style.display = "none";
        }
    };
    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
    }
</script>
